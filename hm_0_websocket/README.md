# HM-0: Простая реализация WebSocket сервера и клиента
---

### Задача:
Написать сервер на сокетах, который отвечает "ОК" при подключении и закрывает соединении. Также написать клиент
на сокете, который будет подключаться и проверять, что он получил "ОК".

### Решение:
1. Для начала необходимо реализовать конфигурационный класс `WebSocketConfig`, настраивающий и регистрирующий
   обработчики запросов: необходимо использовать аннотацию `@EnableWebSocket`. Из описания данной аннотации следует
   необходимость  реализовать интерфейс `WebSocketConfigurer` нашим конфигурационным классом. Интерфейс `WebSocketConfigurer`
   содержит единственный метод `registerWebSocketHandlers(WebSocketHandlerRegistry registry)`, используя входной параметр
   `WebSocketHandlerRegistry` мы осуществляем добавление обработчиков `(WebSocketHandler)` входящих сообщений на определенный `url`.

2. Далее создается обработчик `ConnectionWebSocketHandler` (или обработчики), в котором переопределяется метод
   `afterConnectionEstablished` для обработки события, когда соединение между сервером и клиентом будет установлено, т.е. **"OK""**.

3. Простая реализация клиента - `SimpleWebSocketClient`. В методе `doHandShake` происходит то самое "рукопожатие" между
   клиентом и сервером: код ответа `HTTP 101` говорит об переключении протокола, в нашем случае на `WebSocket`.
   `Sec-WebSocket-Accept` — рассчитанное значение на основе переданного `Sec-WebSocket-Key` и константы
   «258EAFA5-E914-47DA-95CA-C5AB0DC85B11» — по сути это подтверждение от сервера о готовности инициировать `WebSocket` соединение.

**Типичный ответ от сервера:**
```
HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
```
